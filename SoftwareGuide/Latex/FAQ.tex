\section{Introduction}
\subsection{What is OTB?}
OTB, the ORFEO Toolbox is a library of image processing algorithms developed by CNES in the
frame of the ORFEO Accompaniment Program. 
OTB is based on the medical image processing library ITK, \url{http://www.itk.org}, and offers
particular functionalities for remote sensing image processing in
general and for high spatial resolution images in particular.

OTB provides:
\begin{itemize}
\item image access: optimized read/write access for most of remote sensing
image formats, meta-data access, simple visualization;
\item filtering: blurring, denoising, enhancement;
\item feature extraction: interest points, alignments, lines;
\item image segmentation: region growing, watershed, level sets;
\item classification: K-means, SVM, Markov random fields; 
\item change detection.  
\end{itemize}


Many of these functionalities are provided by ITK and have been tested
and documented for the use with remote sensing data.

\subsection{What is ORFEO?}
ORFEO stands for Optical and Radar Federated Earth Observation.  In
2001 a cooperation program was set between France and Italy to develop
ORFEO, an Earth observation dual system with metric resolution: Italy
is in charge of COSMO-Skymed the radar component development, and
France of PLEIADES the optic component.

The PLEIADES optic component is composed of two "small satellites"
(mass of one ton) offering a spatial resolution at nadir of 0.7 m and
a field of view of 20 km. Their great agility enables a daily access
all over the world, essentially for defence and civil security
applications, and a coverage capacity necessary for the cartography
kind of applications at scales better than those accessible to SPOT
family satellites. Moreover, PLEIADES will have stereoscopic
acquisition capacity to meet the fine cartography needs, notably in
urban regions, and to bring more information when used with aerial
photography.

The ORFEO "targeted" acquisition capacities made it a system
particularly adapted to defence or civil security missions, as well as
critical geophysical phenomena survey such as volcanic eruptions,
which require a priority use of the system resources.


With respect to the constraints of the franco-italian agreement,
cooperations have been set up for the PLEIADES optical component with
Sweden, Belgium, Spain and Austria.

\subsubsection{Where can I get more information about ORFEO?}
At the PLEIADES HR web site: \url{http://smsc.cnes.fr/PLEIADES/}.

\subsection{What is the ORFEO Accompaniment Program?}
Beside the Pleiades (PHR) and Cosmo-Skymed (CSK) systems developments forming ORFEO, the dual and bilateral system (France - Italy) for Earth Observation, the ORFEO Accompaniment Program was set up, to prepare, accompany and promote the use and the exploitation of the images derived from these sensors.

The creation of a preparatory program is needed because of :
\begin{itemize}
  \item  the new capabilities and performances of the ORFEO systems (optical and radar high resolution, access capability, data quality, possibility to acquire simultaneously in optic and radar),
  \item the implied need of new methodological developments : new processing methods, or adaptation of existing methods,
  \item the need to realise those new developments in very close cooperation with the final users, the integration of new products in their systems.
\end{itemize}
  

This program was initiated by CNES mid-2003 and will last until 2009.
It consists in two parts, between which it is necessary to keep a strong interaction:
\begin{itemize}
\item A Methodological part,
\item A Thematic part.
\end{itemize}


This Accompaniment Program uses simulated data (acquired during airborne campaigns) and satellite images quite similar to Pleiades (as QuickBird and Ikonos), used in a communal way on a set of special sites. The validation of specified products and services will be realised with those simulated data

Apart from the initial cooperation with Italy, the ORFEO Accompaniment
Program enlarged to Belgium, with integration of Belgian experts in
the different WG as well as a participation to the methodological
part.

\subsubsection{Where can I get more information about the ORFEO
  Accompaniment Program?}
Go to the following web site:
\url{http://smsc.cnes.fr/PLEIADES/A_prog_accomp.htm}.

\subsection{Who is responsible for the OTB development?}
The French Centre National d'\'Etudes Spatiales, CNES, initiated the ORFEO
Toolbox and is responsible for the specification of the library. CNES
funds the industrial development contracts and research contracts
needed for the evolution of OTB.

\section{Licence}
\subsection{Which is the OTB licence?}
OTB is distributed under a free software licence:\\
\url{http://www.cecill.info/licences/Licence_CeCILL_V2-en.html}.


\subsection{If I write an application using OTB am I forced to distribute that application?}
No. The license gives you the option to distribute your application if
you want to. You do not have to exercise this option in the license.

\subsection{If I wanted to distribute an application using OTB what license would I need to use?}
    The CeCILL licence.

\subsection{I am a commercial user. Is there any restriction on the
  use of OTB?}
OTB can be used internally ("in-house") without restriction, but only
redistributed in other software that is under the CeCILL licence.

\section{Getting OTB}
\subsection{Who can download the OTB?}
Anybody can download the OTB at no cost. 
\subsection{Where can I download the OTB?}
Go to \url{http://otb.cnes.fr}
 and follow the "download OTB" link. You will have access to the OTB
source code and to the Software User's Guide.
\section{Installing OTB}
\label{sec:FAQInstall}
\subsection{Which platforms are supported}
OTB is a multi-platform library. It has successfully been installed on
the following platforms:
\begin{itemize}
  \item Linux/Unix with GCC (2.95.X, 3.3.X, 4.1.X, 4.2.X).
  \item Windows with Microsoft Visual Studio C++ 7.1 .NET 2003.
  \item Windows with Microsoft Visual Studio C++ 8.0 .NET 2005.  
  \item Windows with MinGW. (mingw + msys at \url{http://www.mingw.org})
  \item Cygwin. (\url{http://www.cygwin.com})
\end{itemize}

Support for the following platforms is planned:
\begin{itemize}
  \item Windows with Microsoft Visual Studio C++ 6.0.
\end{itemize}

\subsection{Which libraries/packages are needed before installing
 OTB?}
\begin{itemize}
\item CMake (\url{http://www.cmake.org})
\item GDAL (\url{http://www.gdal.org})
\item Fltk (\url{http://www.fltk.org})
\end{itemize}
       
\subsection{Main steps}
In order to install OTB on your system follow these steps (in the
given order):
\begin{enumerate}
  \item Install CMake.
  \item Install GDAL.
  \item Install Fltk using the CMake scripts. Do not use the
  \texttt{configure} approach or the project files for Microsoft
  Visual Studio shipped with Fltk.
  \item Install ITK if you do not want to use the ITK version provided
  with OTB. Use CMake for the configuration.
  \item Install OTB using CMake for the configuration.
\end{enumerate}

We assume that you will install everything on a directory called
\texttt{INSTALL\_DIR}, which usually is \texttt{/usr/local}, \texttt{/home/jordi/local} or
whatever you want. Make sure that you have downloaded the source code for:
  \begin{itemize}
  \item CMake (\url{http://www.cmake.org})
  \item GDAL (\url{http://www.gdal.org})
  \item Fltk (\url{http://www.fltk.org})
  \end{itemize}

\subsubsection{Unix/Linux Platforms}
\begin{enumerate}
    
\item Install GDAL
  \begin{verbatim}
      cd INSTALL_DIR
      gunzip gdal.1.3.2.tar.gz
      tar xvf gdal.1.3.2.tar
      cd gdal.1.3.2
      ./configure --prefix=INSTALL_DIR
      make
      make install
  \end{verbatim}

It seems to be a bug in the GDAL install procedure: if you are installing it without root privileges, even if your \texttt{INSTALL\_DIR} is a directory for which you have the write permissions, GDAL tries to copy the python bindings together with the Python site packages, which are usually somewhere in /usr/lib.

Actually, since this is the last step in the GDAL install procedure, when you get the error message, the GDAL libs and header files are already installed, so you can safely ignore the error.

The \texttt{--without-python} option passed to the \texttt{configure} step avoids this. However, some users may want to have Python bindings, so recommending this option for the install may not be OK for everybody. 

\item Install CMake
  \begin{verbatim}
      cd INSTALL_DIR
      gunzip cmake-2.2.3.tar.gz
      tar xvf cmake-2.2.3.tar
      cd cmake-2.2.3
      ./configure --prefix=INSTALL_DIR
      make
      make install
  \end{verbatim}
      In order to properly use cmake, add \texttt{INSTALL\_DIR/bin} to
      your path with \texttt{export PATH=\$PATH:INSTALL\_DIR/bin} or
      something similar.

\item Install Fltk (optional) using CMake (do not use the configure script)
  \begin{verbatim}
      cd INSTALL_DIR
      bunzip2 fltk-1.1.7-source.tar.bz2 OR
      gunzip fltk-1.1.7-source.tar.gz
      tar xvf fltk-1.1.7-source.tar
      mkdir Fltk-binary
      cd Fltk-binary
      ccmake ../fltk-1.1.7
      --> follow the CMake instructions, in particular:
          --> set CMAKE_INSTALL_PREFIX to INSTALL_DIR within CMake
	  --> set BUILD_EXAMPLES to ON within CMake
	  --> generate the configuration with 'g'
      make
      make install
      --> check that the examples located in
      INSTALL_DIR/Fltk-binary/bin work, in particular, the fractals
      example which makes use of the OpenGL library needed by OTB.
  \end{verbatim}
      

\item Install OTB
  \begin{verbatim}
      cd INSTALL_DIR
      gunzip OrfeoToolbox-2.0.0.tgz
      tar xvf OrfeoToolbox-2.0.0.tar
      mkdir OTB-Binary
      cd OTB-Binary
      ccmake ../OrfeoToolbox-2.0.0
      --> follow the CMake instructions, in particular:
	  --> set BUILD_EXAMPLES to ON within CMake
	  --> set BUILD_SHARED_LIBS to OFF within CMake
	  --> set BUILD_TESTING to OFF within CMake
	  --> set CMAKE_INSTALL_PREFIX to INSTALL_DIR within CMake
	  --> set GDAL_INCLUDE_DIRS to INSTALL_DIR/include within CMake
	  --> set GDAL_LIBRARY_DIRS to INSTALL_DIR/lib within CMake
	  --> set OTB_USE_EXTERNAL_ITK to OFF within CMake
	  --> set FLTK_DIR to INSTALL_DIR/Fltk-Binary within CMake OR
	      if you do not have FLTK press 't' to change to advanced
              mode and set OTB_USE_VISU to OFF 
	  --> generate the configuration with 'g'
       make
       make install
  \end{verbatim}
      
  
\end{enumerate}

\subsubsection{Microsoft Visual Studio C++ 7.1}
\begin{enumerate}
\item Install GDAL

	MSVC++ 7.1 project files are needed to compile GDAL.
	
	These files can be downloaded at \url{http://vterrain.org/dist/gdal132_vc71.zip}.
	
	Then, unzip it to your GDAL folder, and it will create a folder (named "VisualStudio").
	
	Load the solution (.sln file) and build the gdal project.
	
	More details can be found at \url{http://vterrain.org/Distrib/gdal.html}.

\item Install Fltk

	Use CMake on Windows to generate MSVC++ 7.1 project files from fltk sources.
	
	Open the solution and build the fltk project.

\item Install OTB

	Use CMake on Windows to generate MSVC++ 7.1 project files from otb sources.
	
	Open the solution and build the otb project.

\end{enumerate}

\subsubsection{Microsoft Visual Studio C++ 8.0}
\begin{enumerate}
\item Install GDAL

        Open a MS-DOS prompt.
        
        Run the VCVARS32.bat script that comes with the compiler (it can be found in 
        Microsoft Visual Studio 8/VC/bin).
        
        Then, go to the GDAL root directory, and tape : 
        \begin{verbatim}
                nmake /f makefile.vc
        \end{verbatim}
        
        Once the build is successful, tape this line to install GDAL :
        \begin{verbatim}
                nmake /f makefile.vc install
        \end{verbatim}
	
        More details about this install can be found at \url{http://www.gdal.org/gdal_building.html}.
                
        
\item Install Fltk

	Use CMake on Windows to generate MSVC++ 8.0 project files from fltk sources.
	
	Open the solution and build the fltk project.

\item Install OTB

	Use CMake on Windows to generate MSVC++ 8.0 project files from otb sources.
	
	Open the solution and build the otb project.

\end{enumerate}

\subsubsection{MinGW on Windows platform}
\begin{enumerate}

\item Download the lastest version of mingw and msys at \url{http://www.mingw.org} and install those 
	two programs.

	Then, launch MinGW : a promp appears (similar to Linux one).

\item Install GDAL

	To compile GDAL, at configure step, use these options :
\begin{verbatim}
	./configure -prefix=INSTALL_DIR --host=mingw32 --without-libtool 
	--without-python --with-png=internal --with-libtiff=internal
	--with-jpeg=internal
\end{verbatim}
	Then the usual make and make install.

\item Install Fltk

	Generate MSYS Makefiles with CMake (Windows version) from fltk sources.
	
	Then, under prompt, tape make and make install where you have generated Makefiles with CMake.

\item Install OTB

	Similar to fltk install.

\end{enumerate}

\subsubsection{Cygwin}
\begin{enumerate}

\item Download the lastest version at \url{http://www.cygwin.com} and install it.
	Then, launch it, a prompt appears (similar to Linux one).

\item Install GDAL

	To compile GDAL, at configure step, use these options :
\begin{verbatim}
	./configure --prefix=INSTALL_DIR --with-png=internal --with-libtiff=internal
	--with-jpeg=internal
\end{verbatim}
	Then the usual make and make install.

\item Install Fltk

	See Linux part for details (same procedure).

\item Install OTB

	See Linux part for details (same procedure).
\end{enumerate}

That should be all! Otherwise, subscribe to
   otb-users@googlegroups.com and you will get some help.

\subsection{Specific platform issues}
\subsubsection{SunOS/HP UX}
Due to a bug in the tar command shipped with some versions of SunOS,
problems may appear when configuring, compiling or installing OTB.

See \url{http://www.gnu.org/software/tar/manual/tar.html#Checksumming} for
details on the bug characterization.

The solution is to use the GNU tar command if it is available on your
system (gtar).

\subsubsection{Cygwin}
Due to an unknown bug, Fltk can't compile on some versions of Cygwin (OpenGL problems).

Put OTB\_USE\_VISU to OFF to avoid these problems.

Some bugs can appear while compiling GDAL with JPEG2000 files : disable this format to resolve the problem.

\subsubsection{MSVC++ 8.0}
Execution errors can appear on some platforms, using GDAL compiled with MSVC++ 8.0.

This problem can be resolved by downloading GDAL binaries for Windows
at \url{http://vterrain.org/Distrib/gdal.html}.

\section{Using OTB}

\subsection{What is the image size limitation of OTB ?}

The maximum physical space a user can allocate depends on his platform. Therefore, 
image allocation in OTB is restricted by image dimension, size, pixel type and number 
of bands.

Fortunately, thanks to the streaming mechanism implemented within
OTB's pipeline (actually ITK's), this limitation can be bypassed. The
use of the \doxygen{otb}{StreamingImageFileWriter} at the end of the pipeline,
or the \doxygen{itk}{StreamingImageFilter} at any point of the pipeline will
seamlessly break the large, problematic data into small pieces whose
allocation is possible. These pieces are processed one afther the
other, so that there is not allocation problem anymore.

For the streaming to work, all the filters in the pipeline must be streaming capable 
(this is the case for most of the filter in OTB). The output image format also need to be 
streamable (not png or jpeg, but tiff or ENVI, for instance).

To tune the size of the streaming pieces, the OTB has
two CMake variables. The first is named
OTB\_STREAM\_IMAGE\_SIZE\_TO\_ACTIVATE\_STREAMING. It represents the
minimum size of the image in bytes for which streaming may be helpful. The
second, OTB\_STREAM\_MAX\_SIZE\_BUFFER\_FOR\_STREAMING, specifies the
maximum size in bytes a streaming piece should have. It can be used to
compute the optimal number of pieces to break the input data into.

These two parameters have been used in the OTB-Applications/Utils/
applications. Take this as an example of how they can be used. They
can also be tuned by the user to match her specific needs.


\section{Getting help}
\subsection{Is there any mailing list?}
Yes. There is a discussion group at
\url{http://groups.google.com/group/otb-users/} where you can get help
on the set up and the use of OTB.

\subsection{Which is the main source of documentation?}
The main source of documentation is the OTB Software Guide which can
be downloaded at
\url{http://orfeo-toolbox.sourceforge.net/Docs/OTBSoftwareGuide.pdf}. It
contains tenths of commented examples which should be a good starting
point for any new OTB user. The code source for these examples is
distributed with the toolbox. Another information source is the
on-line API documentation which is available at \url{http://orfeo-toolbox.sourceforge.net/Doxygen}.


\section{OTB's Roadmap}
\subsection{Which will be the next version of OTB?}
OTB's version numbers have 3 digits. The first one is for major
versions, the second one is for minor versions and the last one is for
bugfixes.

The first version was 1.0.0. The current one 2.0.0 was released in December 2007. 
The next one will probably be 2.2.0.

\subsubsection{What is a major version?}
A major version of the library implies the addition of high-level
functionalities as for instance image registration, object recognition, etc.

\subsubsection{What is a minor version?}
A minor version is released when low-level functionalities are
available within one major functionality, as for instance a new
change detector, a new feature extractor, etc.

\subsubsection{What is a bugfix version?}
A bugfix version is released when significant bugs are identified and fixed.

\subsection{When will the next version of OTB be available?}
We plan to release major new OTB version once a year, that is, version
2.0.0 should be available end of 2007, version 3.0.0 should be released
mid-2008, and so on.

\subsection{What features will the OTB include and when?}
There is no detailed plan about the availability of OTB new features,
since OTB's content depends on ongoing research work and on feedback
from thematic users of the ORFEO Accompaniment Program.

Nevertheless, the main milestones for the OTB development are the
following:
\begin{itemize}
  \item{Version 1 (2006):}
    \begin{itemize}
    \item core of the system,
    \item IO,
    \item basic filtering, segmentation and classification,
    \item basic feature extraction,
    \item basic change detection.
    \end{itemize}
    \item{Version 2 (2007):}
      \begin{itemize}
      \item geometric corrections,
      \item radiometric corrections,
      \item registration.
      \end{itemize}
    \item{Version 3 (2008):}
      \begin{itemize}
      \item multi-scale and multi-resolution analysis,
      \item object detection and recognition,
      \item supervised learning.
      \end{itemize}
    \item{Version 4 (2009):}
      \begin{itemize}
	\item data fusion,
	\item spatial reasoning.
      \end{itemize}
    
\end{itemize}

%% \subsection{When will feature X or Y be included in OTB?}
